<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formulario opción mundial</title>
    <!-- Favicon -->
    <link rel="icon" type="image/png" href="fabicon.png">
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container d-flex justify-content-center align-items-center">
        <div class="card p-4 shadow-lg w-100">
            <div class="text-center">
                <img src="fundacionopcionmundial.png" alt="Opción Mundial Fundación Internacional" class="logo">
            </div>
            <div class="card mt-3">
                <h2 class="text-center">MATRÍCULA VIRTUAL</h2>
                <p class="text-center">Realiza tu matrícula de forma fácil, rápida y efectiva adjuntando los documentos solicitados.</p>
                <p class="note text-center">(Todos los documentos deben ser en formato PDF, PNG, JPG o JPEG y serán verificados por la Secretaría de Educación para garantizar su autenticidad).</p>
            </div>     

            <!-- Formulario para subir archivos -->
            <form action="upload.php" method="POST" enctype="multipart/form-data" id="uploadForm">
                <div class="mb-3 text-start">
                    <label for="email" class="form-label">CORREO ELECTRÓNICO <span class="required">*</span></label>
                    <input type="email" id="email" name="email" class="form-control" placeholder="Ingrese su correo electrónico" required>
                </div>

                <div class="mb-3 text-start">
                    <label class="form-label">ADJUNTAR COPIA DE DOCUMENTO DE IDENTIDAD <span class="required">*</span></label>
                    <input type="file" class="form-control" name="identificacion" accept=".pdf,.png,.jpg,.jpeg" required>
                </div>

                <div class="mb-3 text-start">
                    <label class="form-label">ADJUNTAR COPIA DE ACTA DE BACHILLER <span class="required">*</span></label>
                    <input type="file" class="form-control" name="acta_bachiller" accept=".pdf,.png,.jpg,.jpeg" required>
                </div>

                <div class="mb-3 text-start">
                    <label class="form-label">ADJUNTAR COPIA DE SISBÉN O RECIBO PÚBLICO <span class="required">*</span></label>
                    <input type="file" class="form-control" name="sisben" accept=".pdf,.png,.jpg,.jpeg" required>
                </div>

                <div class="mb-3 text-start">
                    <label class="form-label">ADJUNTAR FACTURA O RECIBO DE PAGO DEL ABONO INICIAL</label>
                    <input type="file" class="form-control" name="abono" accept=".pdf,.png,.jpg,.jpeg">
                </div>

                <!-- Botón para enviar el formulario -->
                <button type="submit" class="btn btn-primary w-100">Subir Archivos</button>
            </form>
        </div>
    </div>

    <!-- Validación con JavaScript -->
    <script>
        document.getElementById("uploadForm").addEventListener("submit", function (event) {
            const archivos = document.querySelectorAll("input[type='file']");
            const formatosPermitidos = ["pdf", "png", "jpg", "jpeg"];

            for (let archivo of archivos) {
                if (archivo.files.length > 0) {
                    let extension = archivo.files[0].name.split('.').pop().toLowerCase();
                    if (!formatosPermitidos.includes(extension)) {
                        Swal.fire({
                            icon: "error",
                            title: "Formato no permitido",
                            text: `El archivo ${archivo.files[0].name} tiene una extensión no permitida. Solo se permiten PDF, PNG, JPG o JPEG.`,
                            confirmButtonText: "OK"
                        });
                        event.preventDefault();
                        return;
                    }
                }
            }
        });

        // Mostrar alerta si el registro fue exitoso
        document.addEventListener("DOMContentLoaded", function () {
            const urlParams = new URLSearchParams(window.location.search);
            if (urlParams.get("success") === "1") {
                Swal.fire({
                    icon: "success",
                    title: "¡Registro exitoso!",
                    text: "Tus archivos han sido guardados correctamente.",
                    confirmButtonText: "OK"
                });

                // Limpiar el parámetro de la URL sin recargar la página
                window.history.replaceState({}, document.title, window.location.pathname);
            }
        });
    </script>

    <!-- Bootstrap JS Bundle (Popper.js incluido) -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>